import requests
from .utils import invoke_rest_endpoint
from connectors.core.connector import get_logger, ConnectorError
from .constants import LOGGER_NAME
logger = get_logger(LOGGER_NAME)


def search_per_id(config, params):
    cve_id = params.get('cve-id')
    if not cve_id:
        raise ConnectorError('Missing required input')
    endpoint = '/cve/{}'.format(cve_id)
    api_response = invoke_rest_endpoint(config, endpoint, 'GET')
    return api_response
